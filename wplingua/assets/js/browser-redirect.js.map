{"version":3,"file":"browser-redirect.js","sources":["browser-redirect.js"],"sourcesContent":["/**\r\n *                 _     _                         \r\n * __      ___ __ | |   (_)_ __   __ _ _   _  __ _ \r\n * \\ \\ /\\ / / '_ \\| |   | | '_ \\ / _` | | | |/ _` |\r\n *  \\ V  V /| |_) | |___| | | | | (_| | |_| | (_| |\r\n *   \\_/\\_/ | .__/|_____|_|_| |_|\\__, |\\__,_|\\__,_|\r\n *          |_|                  |___/             \r\n *\r\n *        -- wpLingua | WordPress plugin --\r\n *   Translate and make your website multilingual\r\n *\r\n *     https://github.com/julien-jacob/wplingua\r\n *      https://wordpress.org/plugins/wplingua/\r\n *              https://wplingua.com/\r\n *\r\n **/\r\n\r\n(function () {\r\n\r\n    \"use strict\";\r\n\r\n    // ------------------------------------------------------------------------\r\n    // Manage the redirection by browser language\r\n    // ------------------------------------------------------------------------\r\n\r\n    /**\r\n     * Get user browser language\r\n     */\r\n\r\n    const userLang = navigator.language.slice(0, 2);\r\n\r\n    /**\r\n     * Get cookie wplingua-lang\r\n     */\r\n\r\n    const cookieName = 'wplingua-lang';\r\n    let wplinguaCookie;\r\n    const cookieParts = document.cookie.split(';');\r\n    for (let i = 0; i < cookieParts.length; i++) {\r\n        let cookie = cookieParts[i].trim();\r\n        if (cookie.startsWith(cookieName + '=')) {\r\n            wplinguaCookie = cookie.substring(cookieName.length + 1);\r\n            break;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get avalable languages from <link rel=\"alternate\">\r\n     */\r\n\r\n    const availableLanguages = {};\r\n    document.querySelectorAll('link[rel=\"alternate\"][hreflang]').forEach(link => {\r\n        const hreflang = link.getAttribute('hreflang');\r\n        if (hreflang !== 'x-default') {\r\n            availableLanguages[hreflang] = link.href;\r\n        }\r\n    });\r\n\r\n    const currentPageLang = document.documentElement.lang.slice(0, 2).toLowerCase();\r\n\r\n    /**\r\n     * Redirection logical\r\n     */\r\n\r\n    // If the cookie is NOT set, it is a new visitor or an expired cookie.\r\n    if (!wplinguaCookie) {\r\n        // VÃ©rifier si la langue du navigateur est disponible sur le site\r\n        if (availableLanguages[userLang]) {\r\n            // Check if the browser language is available on the site\r\n            if (currentPageLang !== userLang) {\r\n                // Set the cookie to remember the choice and avoid future redirection.\r\n                const date = new Date();\r\n                date.setTime(date.getTime() + (30 * 24 * 60 * 60 * 1000));\r\n                const expires = \"; expires=\" + date.toUTCString();\r\n                document.cookie = cookieName + \"=\" + (userLang || \"\") + expires + \"; path=/\";\r\n\r\n                // Redirect to the corresponding URL\r\n                window.location.href = availableLanguages[userLang];\r\n            }\r\n        }\r\n    }\r\n\r\n})();\r\n"],"names":["userLang","navigator","language","slice","cookieName","let","wplinguaCookie","cookieParts","document","cookie","split","i","length","trim","startsWith","substring","availableLanguages","querySelectorAll","forEach","link","hreflang","getAttribute","href","currentPageLang","documentElement","lang","toLowerCase","date","Date","setTime","getTime","expires","toUTCString","window","location"],"mappings":"AAiBA,CAAA,WAEI,aAUA,IAAMA,EAAWC,UAAUC,SAASC,MAAM,EAAG,CAAC,EAMxCC,EAAa,gBACnBC,IAAIC,EACJ,IAAMC,EAAcC,SAASC,OAAOC,MAAM,GAAG,EAC7C,IAAKL,IAAIM,EAAI,EAAGA,EAAIJ,EAAYK,OAAQD,CAAC,GAAI,CACzCN,IAAII,EAASF,EAAYI,GAAGE,KAAK,EACjC,GAAIJ,EAAOK,WAAWV,EAAa,GAAG,EAAG,CACrCE,EAAiBG,EAAOM,UAAUX,EAAWQ,OAAS,CAAC,EACvD,KACJ,CACJ,CAMA,MAAMI,EAAqB,GAC3BR,SAASS,iBAAiB,iCAAiC,EAAEC,QAAQC,IACjE,IAAMC,EAAWD,EAAKE,aAAa,UAAU,EAC5B,cAAbD,IACAJ,EAAmBI,GAAYD,EAAKG,KAE5C,CAAC,EAED,IAAMC,EAAkBf,SAASgB,gBAAgBC,KAAKtB,MAAM,EAAG,CAAC,EAAEuB,YAAY,EAOzEpB,GAEGU,EAAmBhB,IAEfuB,IAAoBvB,KAEd2B,EAAO,IAAIC,MACZC,QAAQF,EAAKG,QAAQ,EAAI,MAA0B,EAClDC,EAAU,aAAeJ,EAAKK,YAAY,EAChDxB,SAASC,OAASL,EAAa,KAAOJ,GAAY,IAAM+B,EAAU,WAGlEE,OAAOC,SAASZ,KAAON,EAAmBhB,GAKzD,EAAE"}